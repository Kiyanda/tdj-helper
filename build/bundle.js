var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function l(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function c(e,t){e.appendChild(t)}function i(e,t,n){e.insertBefore(t,n||null)}function u(e){e.parentNode.removeChild(e)}function a(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f(e){return document.createElement(e)}function p(e){return document.createTextNode(e)}function d(){return p(" ")}function h(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e){return function(t){return t.preventDefault(),e.call(this,t)}}function g(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function v(e){return""===e?null:+e}function $(e,t){e.value=null==t?"":t}function y(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}e.selectedIndex=-1}let b;function _(e){b=e}function x(){const e=function(){if(!b)throw new Error("Function called outside component initialization");return b}();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const l=function(e,t,n=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(e,n,!1,t),o}(t,n);o.slice().forEach((t=>{t.call(e,l)}))}}}const k=[],w=[],S=[],E=[],O=Promise.resolve();let M=!1;function N(e){S.push(e)}let A=!1;const J=new Set;function T(){if(!A){A=!0;do{for(let e=0;e<k.length;e+=1){const t=k[e];_(t),C(t.$$)}for(_(null),k.length=0;w.length;)w.pop()();for(let e=0;e<S.length;e+=1){const t=S[e];J.has(t)||(J.add(t),t())}S.length=0}while(k.length);for(;E.length;)E.pop()();M=!1,A=!1,J.clear()}}function C(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(N)}}const L=new Set;let j;function H(e,t){e&&e.i&&(L.delete(e),e.i(t))}function q(e,t,n,o){if(e&&e.o){if(L.has(e))return;L.add(e),j.c.push((()=>{L.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}function z(e,t){e.d(1),t.delete(e.key)}function I(e){e&&e.c()}function B(e,n,r,s){const{fragment:c,on_mount:i,on_destroy:u,after_update:a}=e.$$;c&&c.m(n,r),s||N((()=>{const n=i.map(t).filter(l);u?u.push(...n):o(n),e.$$.on_mount=[]})),a.forEach(N)}function D(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function P(e,t){-1===e.$$.dirty[0]&&(k.push(e),M||(M=!0,O.then(T)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function R(t,l,r,s,c,i,a,f=[-1]){const p=b;_(t);const d=t.$$={fragment:null,ctx:null,props:i,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l.context||(p?p.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:l.target||p.$$.root};a&&a(d.root);let h=!1;if(d.ctx=r?r(t,l.props||{},((e,n,...o)=>{const l=o.length?o[0]:n;return d.ctx&&c(d.ctx[e],d.ctx[e]=l)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](l),h&&P(t,e)),n})):[],d.update(),h=!0,o(d.before_update),d.fragment=!!s&&s(d.ctx),l.target){if(l.hydrate){const e=function(e){return Array.from(e.childNodes)}(l.target);d.fragment&&d.fragment.l(e),e.forEach(u)}else d.fragment&&d.fragment.c();l.intro&&H(t.$$.fragment),B(t,l.target,l.anchor,l.customElement),T()}_(p)}class U{$destroy(){D(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const F="TDJ-HELPER";function G(e){let t=localStorage.getItem(F);return t?(t=JSON.parse(t),e?t[e]:t):null}const K={atk:{"天":[10,4],"地":[5,2],"荒":[7,3]},def:{"天":[5,2],"地":[10,4],"荒":[7,3]}},Q=[{label:"--",score:0,type:"atk"},{label:"攻擊",score:11,type:"atk"},{label:"傷害",score:10,type:"atk"},{label:"穿透",score:6,type:"atk"},{label:"暴擊",score:3,type:"atk"},{label:"反擊",score:0,type:"atk"},{label:"氣血",score:7,type:"def"},{label:"免傷",score:5,type:"def"},{label:"防禦",score:1,type:"def"},{label:"抗暴",score:0,type:"def"}].map((e=>(e.range=K[e.type],e)));function V(e){return Q.find((t=>t.label===e))}const W={"天":164,"地":143,"荒":145},X=["荒蟄","頭狼","幽魎","羅鬼","妖術師","朱焰魔火","九環朱蝮","赤練鬼","剛破鬼","凶骸兵","冥葵","屍魔術士","咒石兵","冰魔蠍","死魘鬼卒","鬼面花蛛","百眼翼魔"];function Y(e){return JSON.parse(JSON.stringify(e))}const Z={prop:"--",value:5};function ee(e,t,n){const o=e.slice();return o[7]=t[n],o[9]=n,o}function te(t){let n,o,l,r,s=t[7].label+" "+t[7].score;return{c(){n=f("option"),o=p(s),l=d(),n.__value=r=t[7].label,n.value=n.__value},m(e,t){i(e,n,t),c(n,o),c(n,l)},p:e,d(e){e&&u(n)}}}function ne(t){let n,l,r,s,p,m,b,_,x,k,w=Q,S=[];for(let e=0;e<w.length;e+=1)S[e]=te(ee(t,w,e));return{c(){n=f("div"),l=f("select");for(let e=0;e<S.length;e+=1)S[e].c();r=d(),s=f("input"),p=d(),m=f("div"),b=f("input"),g(l,"class","svelte-1dran9s"),void 0===t[0].prop&&N((()=>t[4].call(l))),g(s,"type","number"),g(s,"max",t[2]),g(s,"min",t[1]),g(s,"class","svelte-1dran9s"),g(b,"type","range"),g(b,"max",t[2]),g(b,"min",t[1]),g(b,"style",_=`--max: ${t[2]};`),g(b,"class","svelte-1dran9s"),g(m,"class","flex svelte-1dran9s"),g(n,"class","flex list-item svelte-1dran9s")},m(e,o){i(e,n,o),c(n,l);for(let e=0;e<S.length;e+=1)S[e].m(l,null);y(l,t[0].prop),c(n,r),c(n,s),$(s,t[0].value),c(n,p),c(n,m),c(m,b),$(b,t[0].value),x||(k=[h(l,"change",t[4]),h(s,"input",t[5]),h(b,"change",t[6]),h(b,"input",t[6])],x=!0)},p(e,[t]){if(0&t){let n;for(w=Q,n=0;n<w.length;n+=1){const o=ee(e,w,n);S[n]?S[n].p(o,t):(S[n]=te(o),S[n].c(),S[n].m(l,null))}for(;n<S.length;n+=1)S[n].d(1);S.length=w.length}1&t&&y(l,e[0].prop),4&t&&g(s,"max",e[2]),2&t&&g(s,"min",e[1]),1&t&&v(s.value)!==e[0].value&&$(s,e[0].value),4&t&&g(b,"max",e[2]),2&t&&g(b,"min",e[1]),4&t&&_!==(_=`--max: ${e[2]};`)&&g(b,"style",_),1&t&&$(b,e[0].value)},i:e,o:e,d(e){e&&u(n),a(S,e),x=!1,o(k)}}}function oe(e,t,n){let o,l,{position:r="天"}=t,{item:s=Y(Z)}=t;return e.$$set=e=>{"position"in e&&n(3,r=e.position),"item"in e&&n(0,s=e.item)},e.$$.update=()=>{9&e.$$.dirty&&n(2,[o,l]=V(s.prop).range[r]||[],o,(n(1,l),n(0,s),n(3,r)))},[s,l,o,r,function(){s.prop=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(0,s)},function(){s.value=v(this.value),n(0,s)},function(){s.value=v(this.value),n(0,s)}]}class le extends U{constructor(e){super(),R(this,e,oe,ne,r,{position:3,item:0})}}const re=[];function se(t,n=e){let o;const l=new Set;function s(e){if(r(t,e)&&(t=e,o)){const e=!re.length;for(const e of l)e[1](),re.push(e,t);if(e){for(let e=0;e<re.length;e+=2)re[e][0](re[e+1]);re.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(r,c=e){const i=[r,c];return l.add(i),1===l.size&&(o=n(s)||e),r(t),()=>{l.delete(i),0===l.size&&(o(),o=null)}}}}const ce=function(){let e=G("historeUrls")||[];const{subscribe:t,set:n,update:o}=se(e);return{subscribe:t,add:e=>o((t=>[...new Set([...t,e])])),remove:e=>o((t=>t.filter((t=>t!==e)))),reset:()=>n([])}}(),ie=function(t,n,r){const c=!Array.isArray(t),i=c?[t]:t,u=n.length<2;return a=t=>{let r=!1;const a=[];let f=0,p=e;const d=()=>{if(f)return;p();const o=n(c?a[0]:a,t);u?t(o):p=l(o)?o:e},h=i.map(((e,t)=>s(e,(e=>{a[t]=e,f&=~(1<<t),r&&d()}),(()=>{f|=1<<t}))));return r=!0,d(),function(){o(h),p()}},{subscribe:se(r,a).subscribe};var a}(ce,(e=>(function(e){if(!e||!e.key)return!1;let t=G()||{};t[e.key]=e.value,localStorage.setItem(F,JSON.stringify(t))}({key:"historeUrls",value:e}),e)));function ue(e,t,n){const o=e.slice();return o[5]=t[n],o}function ae(e,t){let n,l,r,s,a,p,v,$=pe(t[5])+"";function y(){return t[2](t[5])}function b(){return t[3](t[5])}return{key:e,first:null,c(){n=f("div"),l=f("button"),l.textContent="⨯",r=d(),s=f("span"),a=d(),g(l,"class","btn svelte-1iaw0d8"),g(n,"class","li svelte-1iaw0d8"),this.first=n},m(e,t){i(e,n,t),c(n,l),c(n,r),c(n,s),s.innerHTML=$,c(n,a),p||(v=[h(l,"click",m(y)),h(s,"click",m(b))],p=!0)},p(e,n){t=e,1&n&&$!==($=pe(t[5])+"")&&(s.innerHTML=$)},d(e){e&&u(n),p=!1,o(v)}}}function fe(t){let n,o,l,r,s=[],a=new Map,p=t[0];const h=e=>e[5];for(let e=0;e<p.length;e+=1){let n=ue(t,p,e),o=h(n);a.set(o,s[e]=ae(o,n))}return{c(){n=f("details"),o=f("summary"),o.textContent="魂石紀錄:",l=d(),r=f("div");for(let e=0;e<s.length;e+=1)s[e].c();g(r,"class","ul svelte-1iaw0d8"),n.open=!0,g(n,"class","aside svelte-1iaw0d8")},m(e,t){i(e,n,t),c(n,o),c(n,l),c(n,r);for(let e=0;e<s.length;e+=1)s[e].m(r,null)},p(e,[t]){3&t&&(p=e[0],s=function(e,t,n,o,l,r,s,c,i,u,a,f){let p=e.length,d=r.length,h=p;const m={};for(;h--;)m[e[h].key]=h;const g=[],v=new Map,$=new Map;for(h=d;h--;){const e=f(l,r,h),c=n(e);let i=s.get(c);i?o&&i.p(e,t):(i=u(c,e),i.c()),v.set(c,g[h]=i),c in m&&$.set(c,Math.abs(h-m[c]))}const y=new Set,b=new Set;function _(e){H(e,1),e.m(c,a),s.set(e.key,e),a=e.first,d--}for(;p&&d;){const t=g[d-1],n=e[p-1],o=t.key,l=n.key;t===n?(a=t.first,p--,d--):v.has(l)?!s.has(o)||y.has(o)?_(t):b.has(l)?p--:$.get(o)>$.get(l)?(b.add(o),_(t)):(y.add(l),p--):(i(n,s),p--)}for(;p--;){const t=e[p];v.has(t.key)||i(t,s)}for(;d;)_(g[d-1]);return g}(s,t,h,1,e,p,a,r,z,ae,null,ue))},i:e,o:e,d(e){e&&u(n);for(let e=0;e<s.length;e+=1)s[e].d()}}}function pe(e){let t=JSON.parse(e);return[de("",t.title+"‧"+t.position),de("計分",t.score),...t.items.filter((e=>"--"!==e.prop)).map((e=>de(e.prop,e.value)))].join("")}function de(e="",t=""){return`<span class="i ib">\n      <sup>${e}</sup>\n      ${t}\n    </span>`}function he(e,t,n){let o;var l,r;l=ie,r=e=>n(0,o=e),e.$$.on_destroy.push(s(l,r));const c=x();function i(e){c("apply",{url:e})}return[o,i,e=>ce.remove(e),e=>i(e)]}class me extends U{constructor(e){super(),R(this,e,he,fe,r,{})}}function ge(e,t,n){const o=e.slice();return o[19]=t[n],o[20]=t,o[21]=n,o}function ve(e,t,n){const o=e.slice();return o[22]=t[n],o}function $e(t){let n,o;return{c(){n=f("option"),n.__value=o=t[22],n.value=n.__value},m(e,t){i(e,n,t)},p:e,d(e){e&&u(n)}}}function ye(e){let t,n,o;function l(t){e[13](t,e[19],e[20],e[21])}let r={position:e[0]};return void 0!==e[19]&&(r.item=e[19]),t=new le({props:r}),w.push((()=>function(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}(t,"item",l))),{c(){I(t.$$.fragment)},m(e,n){B(t,e,n),o=!0},p(o,l){e=o;const r={};var s;1&l&&(r.position=e[0]),!n&&2&l&&(n=!0,r.item=e[19],s=()=>n=!1,E.push(s)),t.$set(r)},i(e){o||(H(t.$$.fragment,e),o=!0)},o(e){q(t.$$.fragment,e),o=!1},d(e){D(t,e)}}}function be(e){let t,n,l,r,s,v,y,b,_,x,k,w,S,E,O,M,N,A,J,T,C,L,z,P,R,U,F,G,K,Q,V,Y,Z,ee,te,ne,oe,le,re,se,ce,ie,ue,ae,fe,pe,de,he,be,_e,xe,we,Se,Ee=e[3].max+"",Oe=X,Me=[];for(let t=0;t<Oe.length;t+=1)Me[t]=$e(ve(e,Oe,t));let Ne=e[1],Ae=[];for(let t=0;t<Ne.length;t+=1)Ae[t]=ye(ge(e,Ne,t));const Je=e=>q(Ae[e],1,1,(()=>{Ae[e]=null}));return he=new me({}),he.$on("apply",e[6]),{c(){t=f("h1"),t.innerHTML='<ruby>絕品魂石 評估\n    <rt style="color: #0003">天地劫M</rt></ruby> \n  <a href="./weapon" title="go to next">⏵</a>',n=d(),l=f("form"),r=f("fieldset"),s=f("legend"),v=p("絕‧魂石孔位\n      "),y=f("input"),b=d(),_=f("datalist");for(let e=0;e<Me.length;e+=1)Me[e].c();x=d(),k=f("div"),w=f("label"),S=f("input"),E=p("\n        天"),O=d(),M=f("label"),N=f("input"),A=p("\n        地"),J=d(),T=f("label"),C=f("input"),L=p("\n        荒"),z=d(),P=f("fieldset"),R=f("legend"),R.textContent="副屬",U=d();for(let e=0;e<Ae.length;e+=1)Ae[e].c();F=d(),G=f("fieldset"),K=f("legend"),K.textContent="計分",Q=d(),V=f("input"),ee=d(),te=f("sub"),ne=p("/ "),oe=p(Ee),le=d(),re=f("div"),se=f("input"),ie=d(),ue=f("input"),ae=d(),fe=f("input"),de=d(),I(he.$$.fragment),be=d(),_e=f("footer"),_e.innerHTML='<ul><li>Made by Rplus</li> \n    <li>計分標準參考來源：\n      <br/> \n      <a href="https://bbs.nga.cn/read.php?tid=26383169&amp;rand=456" target="_blank" rel="noopener">魂石选择终极攻略 | NGA玩家社区</a></li></ul>',g(y,"class","title svelte-1c4x4cl"),g(y,"type","search"),g(y,"list","rock-types"),g(_,"id","rock-types"),g(S,"type","radio"),g(S,"name","position"),S.__value="天",S.value=S.__value,S.checked=!0,e[10][0].push(S),g(N,"type","radio"),g(N,"name","position"),N.__value="地",N.value=N.__value,e[10][0].push(N),g(C,"type","radio"),g(C,"name","position"),C.__value="荒",C.value=C.__value,e[10][0].push(C),g(k,"class","flex jc-se"),g(V,"type","text"),V.readOnly=!0,g(V,"class","output svelte-1c4x4cl"),V.value=Y=e[3].score,g(V,"style",Z=`--score: ${e[3].score}; --max: ${e[3].max}`),g(te,"class","max svelte-1c4x4cl"),g(se,"class","save svelte-1c4x4cl"),g(se,"type","submit"),se.value="記錄",se.disabled=ce=!e[3].score,g(ue,"type","submit"),ue.value="生成上下限",g(ue,"class","svelte-1c4x4cl"),g(fe,"type","reset"),g(fe,"class","svelte-1c4x4cl"),g(re,"class","flex jc-sb form-btns svelte-1c4x4cl"),g(G,"class",""),g(l,"class","main"),g(l,"style",pe=`--break-point: ${W[e[0]]}`),g(_e,"class","footer")},m(o,u){i(o,t,u),i(o,n,u),i(o,l,u),c(l,r),c(r,s),c(s,v),c(s,y),$(y,e[2]),c(s,b),c(s,_);for(let e=0;e<Me.length;e+=1)Me[e].m(_,null);c(r,x),c(r,k),c(k,w),c(w,S),S.checked=S.__value===e[0],c(w,E),c(k,O),c(k,M),c(M,N),N.checked=N.__value===e[0],c(M,A),c(k,J),c(k,T),c(T,C),C.checked=C.__value===e[0],c(T,L),c(l,z),c(l,P),c(P,R),c(P,U);for(let e=0;e<Ae.length;e+=1)Ae[e].m(P,null);c(l,F),c(l,G),c(G,K),c(G,Q),c(G,V),c(G,ee),c(G,te),c(te,ne),c(te,oe),c(G,le),c(G,re),c(re,se),c(re,ie),c(re,ue),c(re,ae),c(re,fe),i(o,de,u),B(he,o,u),i(o,be,u),i(o,_e,u),xe=!0,we||(Se=[h(y,"input",e[8]),h(S,"change",e[9]),h(N,"change",e[11]),h(C,"change",e[12]),h(se,"click",m(e[4])),h(ue,"click",m(e[5])),h(fe,"click",m(e[7])),h(l,"submit",m(ke))],we=!0)},p(e,[t]){if(4&t&&$(y,e[2]),0&t){let n;for(Oe=X,n=0;n<Oe.length;n+=1){const o=ve(e,Oe,n);Me[n]?Me[n].p(o,t):(Me[n]=$e(o),Me[n].c(),Me[n].m(_,null))}for(;n<Me.length;n+=1)Me[n].d(1);Me.length=Oe.length}if(1&t&&(S.checked=S.__value===e[0]),1&t&&(N.checked=N.__value===e[0]),1&t&&(C.checked=C.__value===e[0]),3&t){let n;for(Ne=e[1],n=0;n<Ne.length;n+=1){const o=ge(e,Ne,n);Ae[n]?(Ae[n].p(o,t),H(Ae[n],1)):(Ae[n]=ye(o),Ae[n].c(),H(Ae[n],1),Ae[n].m(P,null))}for(j={r:0,c:[],p:j},n=Ne.length;n<Ae.length;n+=1)Je(n);j.r||o(j.c),j=j.p}(!xe||8&t&&Y!==(Y=e[3].score)&&V.value!==Y)&&(V.value=Y),(!xe||8&t&&Z!==(Z=`--score: ${e[3].score}; --max: ${e[3].max}`))&&g(V,"style",Z),(!xe||8&t)&&Ee!==(Ee=e[3].max+"")&&function(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}(oe,Ee),(!xe||8&t&&ce!==(ce=!e[3].score))&&(se.disabled=ce),(!xe||1&t&&pe!==(pe=`--break-point: ${W[e[0]]}`))&&g(l,"style",pe)},i(e){if(!xe){for(let e=0;e<Ne.length;e+=1)H(Ae[e]);H(he.$$.fragment,e),xe=!0}},o(e){Ae=Ae.filter(Boolean);for(let e=0;e<Ae.length;e+=1)q(Ae[e]);q(he.$$.fragment,e),xe=!1},d(r){r&&u(t),r&&u(n),r&&u(l),a(Me,r),e[10][0].splice(e[10][0].indexOf(S),1),e[10][0].splice(e[10][0].indexOf(N),1),e[10][0].splice(e[10][0].indexOf(C),1),a(Ae,r),r&&u(de),D(he,r),r&&u(be),r&&u(_e),we=!1,o(Se)}}}function _e(e){return"--"!==e.prop}function xe(){let e=document.querySelector(".aside .ul");e&&(e.scrollTop=e.scrollHeight)}function ke(){}function we(e,t,n){let o,l="天",r=new Array(4),s="";function c(e){return e.reduce(((e,t)=>{let n=V(t.prop),o=n.range[l][0];return e.score+=n.score*t.value,e.max+=n.score*o,e}),{score:0,max:0})}function i(e,t="max",n=""){let o=function(e,t="max"){return Y(e).map((e=>{if(!_e(e))return e;let n=V(e.prop).range[l];switch(t){case"max":e.value=n[0];break;case"min":e.value=n[1];break;case"mid":e.value=Math.round((n[0]+n[1])/2)}return e}))}(e,t),r=c(o).score;ce.add(JSON.stringify({title:s+n,position:l,items:o,score:r}))}return e.$$.update=()=>{2&e.$$.dirty&&n(3,o=c(r)),3&e.$$.dirty&&r.forEach((e=>{let t=V(e.prop),[n,o]=t.range[l];e.value=function(e,t,n){return e<=t?t:e>=n?n:e}(e.value,o,n)}))},[l,r,s,o,function(){o.score&&ce.add(JSON.stringify({title:s,position:l,items:r,score:o.score}))},function(){r.some(_e)&&(i(r,"max","[上]"),i(r,"mid","[中]"),i(r,"min","[下]"),setTimeout(xe,0))},function(e){let t=JSON.parse(e.detail.url);n(0,l=t.position),n(2,s=t.title),n(1,r=t.items)},function(){n(2,s=""),n(1,r=Y(new Array(4).fill(Z)))},function(){s=this.value,n(2,s)},function(){l=this.__value,n(0,l)},[[]],function(){l=this.__value,n(0,l)},function(){l=this.__value,n(0,l)},function(e,t,o,l){o[l]=e,n(1,r)}]}return new class extends U{constructor(e){super(),R(this,e,we,be,r,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
